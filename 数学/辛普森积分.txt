// 辛普森方法求定积分
// fun为被积函数，l为积分下限，r为积分上限，eps为精度限制

#include <iostream>
#include <cstdio>
#include <cstring>
#include <cmath>

using namespace std;

inline double simpson(double (*fun)(double x), double l, double r) {
    return (fun(l) + 4 * fun((l + r) / 2) + fun(r)) * (r - l) / 6;
}

double calc(double (*fun)(double x), double l, double r, double s, double eps) {
    double m = (l + r) / 2, a = simpson(fun, l, m), b = simpson(fun, m, r);
    if (fabs(a + b - s) < 15 * eps) return a + b + (a + b - s) / 15;
    return calc(fun, l, m, a, eps) + calc(fun, m, r, b, eps);
}

inline double integral(double (*fun)(double x), double l, double r, double eps = 1e-8) {
    return calc(fun, l, r, simpson(fun, l, r), eps);
}
